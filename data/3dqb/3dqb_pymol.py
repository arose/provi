import pymol
import math
import sys
import random
from pymol.cgo import *
from pymol.vfont import plain

def resize_plane(p, scale=5):
    center = [ (p[0][i]+p[1][i]+p[2][i])/3 for i in range(3) ]
    sp = []
    for j in range(3):
        va = [ center[i]-p[j][i] for i in range(3) ]
        a = [ center[i]-scale*va[i] for i in range(3) ]
        sp.append(a)
    return sp

def plane_cgo(p, color=[0, 0, 1]):
    plane_cgo = [
        BEGIN, TRIANGLES,
        cgo.ALPHA, 0.5,
        COLOR, color[0], color[1], color[2],
        VERTEX, p[0][0], p[0][1], p[0][2],
        VERTEX, p[1][0], p[1][1], p[1][2],
        VERTEX, p[2][0], p[2][1], p[2][2],
        END
    ]
    return plane_cgo

def hbonds_cgo(hbonds, tmhelices=None):
    hbonds_cgo = []
    if tmhelices:
        def in_which_mem_helix( aa ):
            chain = aa[0]
            number = int( aa[1] )
            for beg, end in tmhelices:
                if beg[0] == chain and end[0] == chain and beg[1] <= number and end[1] >= number:
                    return (beg, end)
            return False
        for don_coords, acc_coords, don_info, acc_info in hbonds:
            mh_acc = in_which_mem_helix( acc_info )
            mh_don = in_which_mem_helix( don_info )
            if mh_acc and mh_don and mh_acc != mh_don:
                hbonds_cgo.extend( [CYLINDER] + don_coords + acc_coords + [0.2,0.3,0.3,1.0,1.0,0.3,0.3] )
    else:
        for don_coords, acc_coords, don_info, acc_info in hbonds:
            hbonds_cgo.extend( [CYLINDER] + don_coords + acc_coords + [0.2,0.3,0.3,1.0,1.0,0.3,0.3] )
    return hbonds_cgo


mplane = [[(-50.657166, -9.320500, 36.971165),(-51.121571,-10.457616, 46.895443),(-52.012226,  0.529834, 38.036398) ],[ (-18.633665, -6.092000, 35.039501),(-19.098070, -7.229115, 44.963779),(-19.988726,  3.758335, 36.104734)]]

hbonds = [([-65.527000000000001, -16.065000000000001, 38.445],
  [-63.454000000000001, -14.898999999999999, 39.954999999999998],
  ('A', 4),
  ('A', 11)),
 ([-67.772000000000006, -14.763, 39.805999999999997],
  [-65.924000000000007, -15.775, 41.847000000000001],
  ('A', 4),
  ('A', 13)),
 ([-62.603999999999999, -12.802, 38.164000000000001],
  [-64.995999999999995, -13.872999999999999, 36.761000000000003],
  ('A', 11),
  ('A', 4)),
 ([-65.527000000000001, -16.065000000000001, 38.445],
  [-63.454000000000001, -14.898999999999999, 39.954999999999998],
  ('A', 4),
  ('A', 11)),
 ([-62.603999999999999, -12.802, 38.164000000000001],
  [-64.995999999999995, -13.872999999999999, 36.761000000000003],
  ('A', 11),
  ('A', 4)),
 ([-67.772000000000006, -14.763, 39.805999999999997],
  [-65.924000000000007, -15.775, 41.847000000000001],
  ('A', 4),
  ('A', 13)),
 ([-68.652000000000001, -8.3699999999999992, 41.700000000000003],
  [-66.039000000000001, -9.2750000000000004, 42.740000000000002],
  ('A', 21),
  ('A', 30)),
 ([-66.039000000000001, -9.2750000000000004, 42.740000000000002],
  [-66.501000000000005, -7.6760000000000002, 40.326999999999998],
  ('A', 30),
  ('A', 21)),
 ([-59.840000000000003, -2.258, 40.848999999999997],
  [-61.902999999999999, -3.4199999999999999, 39.454999999999998],
  ('A', 103),
  ('A', 23)),
 ([-63.764000000000003, -5.2409999999999997, 45.564999999999998],
  [-61.494999999999997, -3.8490000000000002, 45.401000000000003],
  ('A', 28),
  ('A', 101)),
 ([-68.652000000000001, -8.3699999999999992, 41.700000000000003],
  [-66.039000000000001, -9.2750000000000004, 42.740000000000002],
  ('A', 21),
  ('A', 30)),
 ([-66.039000000000001, -9.2750000000000004, 42.740000000000002],
  [-66.501000000000005, -7.6760000000000002, 40.326999999999998],
  ('A', 30),
  ('A', 21)),
 ([-39.880000000000003, -7.3179999999999996, 48.281999999999996],
  [-42.348999999999997, -7.7709999999999999, 49.454999999999998],
  ('A', 297),
  ('A', 43)),
 ([-33.905000000000001, -0.13300000000000001, 41.140000000000001],
  [-34.183999999999997, -2.5979999999999999, 40.426000000000002],
  ('A', 55),
  ('A', 83)),
 ([-21.713000000000001, 11.047000000000001, 36.061],
  [-23.151, 9.1940000000000008, 37.076000000000001],
  ('A', 69),
  ('A', 62)),
 ([-21.713000000000001, 11.047000000000001, 36.061],
  [-23.437000000000001, 12.884, 37.453000000000003],
  ('A', 69),
  ('A', 63)),
 ([-21.311, 9.8580000000000005, 44.240000000000002],
  [-23.600000000000001, 10.643000000000001, 46.055],
  ('A', 65),
  ('A', 320)),
 ([-23.600000000000001, 10.643000000000001, 46.055],
  [-21.311, 9.8580000000000005, 44.240000000000002],
  ('A', 320),
  ('A', 65)),
 ([-21.713000000000001, 11.047000000000001, 36.061],
  [-23.151, 9.1940000000000008, 37.076000000000001],
  ('A', 69),
  ('A', 62)),
 ([-21.713000000000001, 11.047000000000001, 36.061],
  [-23.437000000000001, 12.884, 37.453000000000003],
  ('A', 69),
  ('A', 63)),
 ([-31.914000000000001, -3.0800000000000001, 31.175000000000001],
  [-31.888000000000002, -5.3019999999999996, 32.82],
  ('A', 78),
  ('A', 127)),
 ([-33.905000000000001, -0.13300000000000001, 41.140000000000001],
  [-34.183999999999997, -2.5979999999999999, 40.426000000000002],
  ('A', 55),
  ('A', 83)),
 ([-54.896000000000001, -0.95899999999999996, 42.796999999999997],
  [-54.692999999999998, -2.9649999999999999, 40.991],
  ('A', 97),
  ('A', 185)),
 ([-57.128999999999998, -3.8460000000000001, 44.695],
  [-57.768000000000001, -0.13100000000000001, 44.988999999999997],
  ('A', 185),
  ('A', 97)),
 ([-63.764000000000003, -5.2409999999999997, 45.564999999999998],
  [-61.494999999999997, -3.8490000000000002, 45.401000000000003],
  ('A', 28),
  ('A', 101)),
 ([-59.840000000000003, -2.258, 40.848999999999997],
  [-61.902999999999999, -3.4199999999999999, 39.454999999999998],
  ('A', 103),
  ('A', 23)),
 ([-55.938000000000002, -4.9119999999999999, 33.655000000000001],
  [-56.049999999999997, -7.2679999999999998, 31.114999999999998],
  ('A', 110),
  ('A', 178)),
 ([-52.784999999999997, -5.2750000000000004, 37.701999999999998],
  [-51.165999999999997, -2.4199999999999999, 38.503],
  ('A', 187),
  ('A', 113)),
 ([-45.887999999999998, -6.798, 31.23],
  [-47.747, -6.5419999999999998, 29.207000000000001],
  ('A', 118),
  ('A', 178)),
 ([-47.747, -6.5419999999999998, 29.207000000000001],
  [-45.887999999999998, -6.798, 31.23],
  ('A', 178),
  ('A', 118)),
 ([-43.301000000000002, -10.715, 28.876000000000001],
  [-40.177, -11.372, 30.152000000000001],
  ('A', 167),
  ('A', 122)),
 ([-36.505000000000003, -11.67, 28.504000000000001],
  [-39.005000000000003, -13.042, 27.893000000000001],
  ('A', 126),
  ('A', 211)),
 ([-31.914000000000001, -3.0800000000000001, 31.175000000000001],
  [-31.888000000000002, -5.3019999999999996, 32.82],
  ('A', 78),
  ('A', 127)),
 ([-23.41, -16.303999999999998, 30.794],
  [-22.515000000000001, -13.148999999999999, 32.423999999999999],
  ('A', 222),
  ('A', 132)),
 ([-23.076000000000001, -10.007, 38.658000000000001],
  [-24.302, -12.074999999999999, 37.052],
  ('A', 135),
  ('A', 223)),
 ([-22.231000000000002, -7.8949999999999996, 38.969000000000001],
  [-19.710999999999999, -6.5469999999999997, 38.475999999999999],
  ('A', 135),
  ('B', 347)),
 ([-16.308, -17.239999999999998, 32.984000000000002],
  [-16.456, -20.111999999999998, 34.936999999999998],
  ('A', 140),
  ('A', 225)),
 ([-16.308, -17.239999999999998, 32.984000000000002],
  [-13.792999999999999, -19.032, 33.738],
  ('A', 140),
  ('A', 229)),
 ([-13.792999999999999, -19.032, 33.738],
  [-16.308, -17.239999999999998, 32.984000000000002],
  ('A', 229),
  ('A', 140)),
 ([-41.354999999999997, -13.369999999999999, 23.634],
  [-42.709000000000003, -11.092000000000001, 23.664999999999999],
  ('A', 206),
  ('A', 166)),
 ([-43.301000000000002, -10.715, 28.876000000000001],
  [-40.177, -11.372, 30.152000000000001],
  ('A', 167),
  ('A', 122)),
 ([-43.301000000000002, -10.715, 28.876000000000001],
  [-44.054000000000002, -14.023999999999999, 29.329999999999998],
  ('A', 167),
  ('A', 207)),
 ([-47.747, -6.5419999999999998, 29.207000000000001],
  [-47.347999999999999, -6.3010000000000002, 26.716000000000001],
  ('A', 178),
  ('A', 168)),
 ([-49.731000000000002, -16.594999999999999, 22.268000000000001],
  [-49.786000000000001, -19.367000000000001, 22.402000000000001],
  ('A', 175),
  ('A', 202)),
 ([-52.363, -13.555999999999999, 24.669],
  [-53.710000000000001, -15.263999999999999, 22.783000000000001],
  ('A', 176),
  ('A', 198)),
 ([-51.884999999999998, -13.742000000000001, 28.332000000000001],
  [-52.686, -15.489000000000001, 30.594000000000001],
  ('A', 176),
  ('A', 190)),
 ([-57.826000000000001, -12.504, 29.312999999999999],
  [-56.762, -14.788, 31.030000000000001],
  ('A', 177),
  ('A', 190)),
 ([-59.399999999999999, -13.589, 30.574999999999999],
  [-56.762, -14.788, 31.030000000000001],
  ('A', 177),
  ('A', 190)),
 ([-52.427, -12.654, 31.763000000000002],
  [-53.412999999999997, -10.624000000000001, 30.038],
  ('A', 190),
  ('A', 177)),
 ([-55.938000000000002, -4.9119999999999999, 33.655000000000001],
  [-56.049999999999997, -7.2679999999999998, 31.114999999999998],
  ('A', 110),
  ('A', 178)),
 ([-45.887999999999998, -6.798, 31.23],
  [-47.747, -6.5419999999999998, 29.207000000000001],
  ('A', 118),
  ('A', 178)),
 ([-47.747, -6.5419999999999998, 29.207000000000001],
  [-45.887999999999998, -6.798, 31.23],
  ('A', 178),
  ('A', 118)),
 ([-47.747, -6.5419999999999998, 29.207000000000001],
  [-47.347999999999999, -6.3010000000000002, 26.716000000000001],
  ('A', 178),
  ('A', 168)),
 ([-55.280000000000001, -8.6769999999999996, 32.668999999999997],
  [-52.261000000000003, -9.516, 33.210999999999999],
  ('A', 179),
  ('A', 188)),
 ([-52.039999999999999, -7.9800000000000004, 35.481000000000002],
  [-54.956000000000003, -8.6839999999999993, 35.280000000000001],
  ('A', 188),
  ('A', 179)),
 ([-54.896000000000001, -0.95899999999999996, 42.796999999999997],
  [-54.692999999999998, -2.9649999999999999, 40.991],
  ('A', 97),
  ('A', 185)),
 ([-57.128999999999998, -3.8460000000000001, 44.695],
  [-57.768000000000001, -0.13100000000000001, 44.988999999999997],
  ('A', 185),
  ('A', 97)),
 ([-52.784999999999997, -5.2750000000000004, 37.701999999999998],
  [-51.165999999999997, -2.4199999999999999, 38.503],
  ('A', 187),
  ('A', 113)),
 ([-55.280000000000001, -8.6769999999999996, 32.668999999999997],
  [-52.261000000000003, -9.516, 33.210999999999999],
  ('A', 179),
  ('A', 188)),
 ([-52.039999999999999, -7.9800000000000004, 35.481000000000002],
  [-54.956000000000003, -8.6839999999999993, 35.280000000000001],
  ('A', 188),
  ('A', 179)),
 ([-51.884999999999998, -13.742000000000001, 28.332000000000001],
  [-52.686, -15.489000000000001, 30.594000000000001],
  ('A', 176),
  ('A', 190)),
 ([-57.826000000000001, -12.504, 29.312999999999999],
  [-56.762, -14.788, 31.030000000000001],
  ('A', 177),
  ('A', 190)),
 ([-59.399999999999999, -13.589, 30.574999999999999],
  [-56.762, -14.788, 31.030000000000001],
  ('A', 177),
  ('A', 190)),
 ([-52.427, -12.654, 31.763000000000002],
  [-53.412999999999997, -10.624000000000001, 30.038],
  ('A', 190),
  ('A', 177)),
 ([-55.822000000000003, -16.122, 28.866],
  [-56.762, -14.788, 31.030000000000001],
  ('A', 200),
  ('A', 190)),
 ([-55.822000000000003, -16.122, 28.866],
  [-56.405000000000001, -18.387, 30.231000000000002],
  ('A', 200),
  ('A', 193)),
 ([-52.363, -13.555999999999999, 24.669],
  [-53.710000000000001, -15.263999999999999, 22.783000000000001],
  ('A', 176),
  ('A', 198)),
 ([-55.822000000000003, -16.122, 28.866],
  [-56.762, -14.788, 31.030000000000001],
  ('A', 200),
  ('A', 190)),
 ([-55.822000000000003, -16.122, 28.866],
  [-56.405000000000001, -18.387, 30.231000000000002],
  ('A', 200),
  ('A', 193)),
 ([-49.731000000000002, -16.594999999999999, 22.268000000000001],
  [-49.786000000000001, -19.367000000000001, 22.402000000000001],
  ('A', 175),
  ('A', 202)),
 ([-41.354999999999997, -13.369999999999999, 23.634],
  [-42.709000000000003, -11.092000000000001, 23.664999999999999],
  ('A', 206),
  ('A', 166)),
 ([-43.301000000000002, -10.715, 28.876000000000001],
  [-44.054000000000002, -14.023999999999999, 29.329999999999998],
  ('A', 167),
  ('A', 207)),
 ([-36.505000000000003, -11.67, 28.504000000000001],
  [-39.005000000000003, -13.042, 27.893000000000001],
  ('A', 126),
  ('A', 211)),
 ([-23.41, -16.303999999999998, 30.794],
  [-22.515000000000001, -13.148999999999999, 32.423999999999999],
  ('A', 222),
  ('A', 132)),
 ([-23.076000000000001, -10.007, 38.658000000000001],
  [-24.302, -12.074999999999999, 37.052],
  ('A', 135),
  ('A', 223)),
 ([-16.308, -17.239999999999998, 32.984000000000002],
  [-16.456, -20.111999999999998, 34.936999999999998],
  ('A', 140),
  ('A', 225)),
 ([-16.308, -17.239999999999998, 32.984000000000002],
  [-13.792999999999999, -19.032, 33.738],
  ('A', 140),
  ('A', 229)),
 ([-13.792999999999999, -19.032, 33.738],
  [-16.308, -17.239999999999998, 32.984000000000002],
  ('A', 229),
  ('A', 140)),
 ([-16.164999999999999, -21.994, 44.945999999999998],
  [-14.144, -19.971, 46.084000000000003],
  ('A', 231),
  ('A', 247)),
 ([-16.164999999999999, -21.994, 44.945999999999998],
  [-17.245000000000001, -19.632000000000001, 44.530000000000001],
  ('A', 231),
  ('A', 251)),
 ([-5.6829999999999998, -18.989999999999998, 45.899000000000001],
  [-5.3970000000000002, -20.718, 43.359999999999999],
  ('A', 244),
  ('A', 234)),
 ([-5.6829999999999998, -18.989999999999998, 45.899000000000001],
  [-3.1499999999999999, -18.065000000000001, 44.546999999999997],
  ('A', 244),
  ('A', 237)),
 ([-5.6829999999999998, -18.989999999999998, 45.899000000000001],
  [-5.3970000000000002, -20.718, 43.359999999999999],
  ('A', 244),
  ('A', 234)),
 ([-5.6829999999999998, -18.989999999999998, 45.899000000000001],
  [-3.1499999999999999, -18.065000000000001, 44.546999999999997],
  ('A', 244),
  ('A', 237)),
 ([-16.164999999999999, -21.994, 44.945999999999998],
  [-14.144, -19.971, 46.084000000000003],
  ('A', 231),
  ('A', 247)),
 ([-16.164999999999999, -21.994, 44.945999999999998],
  [-17.245000000000001, -19.632000000000001, 44.530000000000001],
  ('A', 231),
  ('A', 251)),
 ([-37.204000000000001, -11.499000000000001, 44.137999999999998],
  [-40.255000000000003, -11.114000000000001, 44.347999999999999],
  ('A', 301),
  ('A', 294)),
 ([-39.880000000000003, -7.3179999999999996, 48.281999999999996],
  [-42.348999999999997, -7.7709999999999999, 49.454999999999998],
  ('A', 297),
  ('A', 43)),
 ([-37.204000000000001, -11.499000000000001, 44.137999999999998],
  [-40.255000000000003, -11.114000000000001, 44.347999999999999],
  ('A', 301),
  ('A', 294)),
 ([-21.047000000000001, -1.9950000000000001, 49.652999999999999],
  [-23.716000000000001, -2.423, 48.271000000000001],
  ('A', 314),
  ('A', 308)),
 ([-16.068000000000001, -1.2809999999999999, 40.628],
  [-14.787000000000001, -3.6789999999999998, 39.555],
  ('A', 312),
  ('B', 345)),
 ([-21.047000000000001, -1.9950000000000001, 49.652999999999999],
  [-23.716000000000001, -2.423, 48.271000000000001],
  ('A', 314),
  ('A', 308)),
 ([-21.311, 9.8580000000000005, 44.240000000000002],
  [-23.600000000000001, 10.643000000000001, 46.055],
  ('A', 65),
  ('A', 320)),
 ([-23.600000000000001, 10.643000000000001, 46.055],
  [-21.311, 9.8580000000000005, 44.240000000000002],
  ('A', 320),
  ('A', 65)),
 ([-15.881, -8.3390000000000004, 42.548000000000002],
  [-15.282, -7.2990000000000004, 39.491999999999997],
  ('B', 350),
  ('B', 344)),
 ([-16.068000000000001, -1.2809999999999999, 40.628],
  [-14.787000000000001, -3.6789999999999998, 39.555],
  ('A', 312),
  ('B', 345)),
 ([-22.231000000000002, -7.8949999999999996, 38.969000000000001],
  [-19.710999999999999, -6.5469999999999997, 38.475999999999999],
  ('A', 135),
  ('B', 347)),
 ([-15.881, -8.3390000000000004, 42.548000000000002],
  [-15.282, -7.2990000000000004, 39.491999999999997],
  ('B', 350),
  ('B', 344))]

tmhelices = [(('A', 40), ('A', 65)),
 (('A', 69), ('A', 96)),
 (('A', 113), ('A', 137)),
 (('A', 150), ('A', 171)),
 (('A', 204), ('A', 228)),
 (('A', 251), ('A', 274)),
 (('A', 290), ('A', 311))]

interface = [271,
 272,
 273,
 274,
 277,
 280,
 282,
 283,
 286,
 287,
 288,
 305,
 306,
 307,
 308,
 309,
 310,
 311,
 312,
 313,
 314,
 315,
 316,
 317,
 318,
 319,
 320,
 321,
 322,
 323,
 324,
 325,
 327,
 328,
 329,
 330,
 331,
 332,
 333,
 334,
 335,
 336,
 337,
 338,
 340,
 341,
 342,
 343,
 344,
 345,
 346,
 347,
 353,
 354,
 355,
 357,
 358,
 359,
 360,
 361,
 362,
 363,
 364,
 365,
 366,
 367,
 368,
 369,
 371,
 372,
 373,
 374,
 380,
 381,
 382,
 385,
 386,
 387,
 388,
 389,
 390,
 391,
 392,
 393,
 394,
 395,
 396,
 397,
 398,
 399,
 400,
 401,
 402,
 403,
 404,
 405,
 406,
 415,
 416,
 417,
 418,
 419,
 420,
 421,
 422,
 423,
 424,
 425,
 426,
 427,
 428,
 429,
 430,
 431,
 433,
 434,
 435,
 436,
 446,
 448,
 449,
 450,
 451,
 452,
 453,
 454,
 455,
 456,
 457,
 460,
 461,
 462,
 463,
 472,
 473,
 474,
 475,
 476,
 477,
 478,
 479,
 480,
 481,
 482,
 483,
 484,
 485,
 486,
 487,
 488,
 489,
 490,
 499,
 500,
 501,
 502,
 503,
 504,
 505,
 506,
 507,
 508,
 509,
 510,
 511,
 512,
 513,
 514,
 515,
 516,
 517,
 518,
 519,
 520,
 521,
 522,
 523,
 526,
 527,
 528,
 529,
 530,
 531,
 532,
 533,
 534,
 535,
 536,
 537,
 538,
 539,
 541,
 542,
 551,
 552,
 557,
 558,
 559,
 560,
 561,
 562,
 563,
 564,
 565,
 566,
 567,
 568,
 569,
 570,
 571,
 572,
 574,
 575,
 576,
 579,
 580,
 581,
 591,
 592,
 593,
 594,
 595,
 598,
 599,
 600,
 601,
 602,
 603,
 604,
 605,
 606,
 607,
 608,
 609,
 610,
 624,
 625,
 627,
 628,
 629,
 630,
 631,
 632,
 633,
 634,
 635,
 636,
 637,
 638,
 639,
 640,
 656,
 657,
 658,
 659,
 660,
 661,
 676,
 677,
 678,
 679,
 680,
 681,
 682,
 683,
 684,
 685,
 686,
 687,
 688,
 689,
 690,
 691,
 692,
 693,
 707,
 709,
 710,
 711,
 712,
 713,
 714,
 715,
 716,
 717,
 718,
 719,
 720,
 721,
 722,
 723,
 740,
 741,
 742,
 743,
 744,
 745,
 746,
 747,
 748,
 749,
 750,
 751,
 752,
 757,
 758,
 759,
 761,
 762,
 763,
 764,
 765,
 766,
 767,
 768,
 769,
 770,
 772,
 773,
 774,
 775,
 776,
 777,
 778,
 797,
 798,
 799,
 800,
 835,
 836,
 837,
 849,
 850,
 851,
 852,
 853,
 854,
 855,
 874,
 875,
 876,
 877,
 878,
 885,
 886,
 887,
 888,
 892,
 893,
 894,
 895,
 896,
 897,
 898,
 899,
 900,
 901,
 902,
 903,
 904,
 905,
 917,
 918,
 919,
 920,
 921,
 922,
 923,
 925,
 928,
 929,
 930,
 931,
 932,
 933,
 934,
 952,
 953,
 954,
 1002,
 1003,
 1004,
 1005,
 1006,
 1025,
 1026,
 1029,
 1030,
 1031,
 1032,
 1033,
 1034,
 1042,
 1049,
 1050,
 1051,
 1052,
 1053,
 1054,
 1055,
 1056,
 1057,
 1060,
 1061,
 1062,
 1064,
 1073,
 1074,
 1075,
 1080,
 1081,
 1082,
 1083,
 1084,
 1085,
 1086,
 1087,
 1092,
 1093,
 1094,
 1110,
 1111,
 1112,
 1113,
 1114,
 1124,
 1125,
 1128,
 1129,
 1130,
 1132,
 1135,
 1136,
 1137,
 1138,
 1142,
 1154,
 1157,
 1158,
 1159,
 1160,
 1161,
 1162,
 1163,
 1180,
 1181,
 1183,
 1185,
 1186,
 1187,
 1188,
 1189,
 1190,
 1191,
 1192,
 1194,
 1195,
 1196,
 1197,
 1198,
 1199,
 1200,
 1201,
 1202,
 1203,
 1204,
 1205,
 1206,
 1207,
 1208,
 1209,
 1210,
 1211,
 1212,
 1213,
 1214,
 1215,
 1216,
 1217,
 1218,
 1219,
 1222,
 1223,
 1224,
 1225,
 1226,
 1227,
 1228,
 1229,
 1230,
 1231,
 1232,
 1233,
 1234,
 1235,
 1236,
 1237,
 1238,
 1239,
 1240,
 1241,
 1243,
 1244,
 1245,
 1246,
 1247,
 1248,
 1249,
 1250,
 1251,
 1252,
 1253,
 1254,
 1255,
 1256,
 1258,
 1259,
 1260,
 1261,
 1262,
 1263,
 1264,
 1273,
 1274,
 1275,
 1276,
 1277,
 1278,
 1279,
 1280,
 1281,
 1282,
 1283,
 1284,
 1285,
 1286,
 1287,
 1288,
 1289,
 1290,
 1291,
 1292,
 1298,
 1299,
 1300,
 1307,
 1308,
 1309,
 1310,
 1311,
 1312,
 1313,
 1314,
 1315,
 1316,
 1317,
 1318,
 1319,
 1331,
 1332,
 1333,
 1334,
 1335,
 1336,
 1337,
 1338,
 1339,
 1340,
 1341,
 1350,
 1351,
 1352,
 1353,
 1354,
 1355,
 1356,
 1357,
 1361,
 1362,
 1363,
 1368,
 1369,
 1372,
 1373,
 1374,
 1375,
 1376,
 1377,
 1378,
 1379,
 1380,
 1381,
 1427,
 1428,
 1429,
 1430,
 1431,
 1432,
 1434,
 1435,
 1436,
 1437,
 1439,
 1440,
 1441,
 1443,
 1444,
 1445,
 1446,
 1447,
 1457,
 1458,
 1460,
 1462,
 1463,
 1466,
 1467,
 1571,
 1572,
 1584,
 1585,
 1586,
 1587,
 1588,
 1589,
 1591,
 1592,
 1593,
 1594,
 1595,
 1596,
 1597,
 1598,
 1599,
 1610,
 1611,
 1612,
 1613,
 1614,
 1616,
 1617,
 1618,
 1619,
 1620,
 1621,
 1622,
 1623,
 1624,
 1625,
 1626,
 1627,
 1628,
 1629,
 1630,
 1631,
 1632,
 1633,
 1634,
 1635,
 1648,
 1649,
 1650,
 1651,
 1652,
 1653,
 1654,
 1655,
 1656,
 1657,
 1658,
 1659,
 1660,
 1661,
 1662,
 1663,
 1664,
 1665,
 1666,
 1667,
 1668,
 1677,
 1678,
 1686,
 1687,
 1688,
 1689,
 1691,
 1692,
 1693,
 1694,
 1695,
 1696,
 1697,
 1698,
 1699,
 1700,
 1701,
 1702,
 1703,
 1704,
 1705,
 1714,
 1715,
 1716,
 1717,
 1718,
 1719,
 1720,
 1721,
 1722,
 1723,
 1724,
 1725,
 1726,
 1727,
 1728,
 1729,
 1730,
 1731,
 1732,
 1733,
 1734,
 1735,
 1738,
 1739,
 1744,
 1745,
 1746,
 1747,
 1748,
 1749,
 1750,
 1751,
 1752,
 1753,
 1754,
 1755,
 1756,
 1757,
 1758,
 1759,
 1760,
 1761,
 1762,
 1763,
 1764,
 1765,
 1770,
 1771,
 1772,
 1773,
 1774,
 1775,
 1776,
 1777,
 1784,
 1785,
 1786,
 1787,
 1788,
 1789,
 1790,
 1791,
 1792,
 1793,
 1794,
 1795,
 1796,
 1806,
 1807,
 1808,
 1809,
 1810,
 1811,
 1812,
 1813,
 1814,
 1816,
 1817,
 1818,
 1819,
 1821,
 1822,
 1823,
 1824,
 1827,
 1828,
 1841,
 1842,
 1843,
 1844,
 1845,
 1960,
 1961,
 1962,
 1963,
 1964,
 1965,
 1966,
 1967,
 1968,
 1969,
 1970,
 1971,
 1972,
 1973,
 1974,
 1976,
 1977,
 1978,
 1979,
 1980,
 1989,
 1990,
 1991,
 1992,
 1993,
 1994,
 1995,
 1996,
 1997,
 1998,
 1999,
 2000,
 2001,
 2002,
 2003,
 2004,
 2005,
 2010,
 2011,
 2012,
 2013,
 2015,
 2016,
 2017,
 2018,
 2019,
 2020,
 2021,
 2022,
 2023,
 2024,
 2025,
 2026,
 2027,
 2028,
 2029,
 2030,
 2031,
 2032,
 2033,
 2034,
 2035,
 2036,
 2042,
 2043,
 2044,
 2047,
 2049,
 2050,
 2051,
 2052,
 2053,
 2054,
 2055,
 2056,
 2057,
 2058,
 2059,
 2060,
 2061,
 2062,
 2063,
 2064,
 2077,
 2078,
 2079,
 2080,
 2081,
 2082,
 2083,
 2084,
 2085,
 2086,
 2087,
 2088,
 2089,
 2090,
 2091,
 2113,
 2114,
 2115,
 2116,
 2117,
 2118,
 2119,
 2120,
 2121,
 2122,
 2123,
 2124,
 2125,
 2126,
 2140,
 2141,
 2142,
 2143,
 2144,
 2145,
 2146,
 2147,
 2148,
 2149,
 2150,
 2152,
 2153,
 2154,
 2156,
 2157,
 2158,
 2159,
 2160,
 2161,
 2162,
 2163,
 2164,
 2165,
 2166,
 2167,
 2168,
 2169,
 2170,
 2171,
 2172,
 2175,
 2176,
 2177,
 2178,
 2179,
 2180,
 2195,
 2196,
 2197,
 2198,
 2199,
 2200,
 2201,
 2203,
 2206,
 2207,
 2208,
 2215,
 2217,
 2218,
 2254,
 2255,
 2256,
 2269,
 2270,
 2271,
 2272,
 2274,
 2275,
 2276,
 2277,
 2278,
 2279,
 2280,
 2281,
 2282,
 2284,
 2285,
 2286,
 2296,
 2297,
 2298,
 2299,
 2300,
 2301,
 2302,
 2303,
 2304,
 2305,
 2306,
 2307,
 2308,
 2309,
 2310,
 2311,
 2314,
 2315,
 2316,
 2318,
 2319,
 2320,
 2321,
 2322,
 2323,
 2324,
 2325,
 2326,
 2327,
 2328,
 2329,
 2330,
 2331,
 2332,
 2334,
 2337,
 2338,
 2339,
 2340,
 2341,
 2342,
 2343,
 2353,
 2354,
 2355,
 2356,
 2357,
 2360,
 2361,
 2362,
 2363,
 2364,
 2377,
 2378,
 2379,
 2380,
 2381,
 2382,
 2383,
 2384,
 2385,
 2386,
 2387,
 2388,
 2389,
 2390,
 2391,
 2392,
 2393,
 2394,
 2412,
 2413,
 2414,
 2415,
 2416,
 2417,
 2418,
 2419,
 2420,
 2421,
 2422,
 2423,
 2424,
 2425,
 2426,
 2427,
 2428,
 2429,
 2430,
 2431,
 2432,
 2434,
 2437,
 2446,
 2447,
 2448,
 2449,
 2450,
 2451,
 2452,
 2453,
 2454,
 2455,
 2456,
 2457,
 2458,
 2459,
 2460,
 2461,
 2462,
 2463,
 2465,
 2466,
 2467,
 2469,
 2470,
 2473,
 2474,
 2475,
 2476,
 2499,
 2500,
 2501,
 2502,
 2503,
 2504,
 2505,
 2506,
 2507,
 2508,
 2509,
 2510,
 2513,
 2514,
 2515,
 2524,
 2525,
 2526,
 2527,
 2528,
 2529,
 2530,
 2531,
 2532,
 2533,
 2534,
 2535,
 2536,
 2537,
 2540,
 2541,
 2542,
 2544,
 2545,
 2546,
 2547,
 2548,
 2549,
 2550,
 2551,
 2552,
 2553,
 2554,
 2555,
 2556,
 2557,
 2558,
 2559,
 2560,
 2561,
 2562,
 2563,
 2564,
 2565,
 2566,
 2567,
 2568,
 2569,
 2570,
 2571,
 2572,
 2573,
 2574,
 2575,
 2576,
 2577,
 2578,
 2579,
 2580,
 2581,
 2585,
 2586,
 2587,
 2588,
 2589,
 2590,
 2592,
 2654,
 2658,
 2659,
 2660,
 2661,
 2662,
 2663,
 2664,
 2665,
 2666,
 2668,
 2669,
 2670,
 2671,
 2680]

cmd.hide('all')
cmd.show('cartoon')
cmd.show('lines')
cmd.color('grey')

mp_cgo = plane_cgo( resize_plane(mplane[0]) ) + plane_cgo( resize_plane(mplane[1]) )
cmd.load_cgo( mp_cgo, 'membrane planes')

cmd.load_cgo( hbonds_cgo(hbonds), 'hbonds (all available)')
cmd.load_cgo( hbonds_cgo(hbonds, tmhelices), 'hbonds (interhelical)')

# crashes pymol
#cmd.select( 'interface', "id " + ("+".join( [str(i) for i in interface] )) )
cmd.select( 'interface', "id " + str(interface[0]) )
for i in interface:
    cmd.select( 'interface', "id " + str(i) + " or interface" )
cmd.color('yellow', 'interface')
    